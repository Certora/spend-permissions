// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import {Script, console2} from "forge-std/Script.sol";
import {Strings} from "openzeppelin-contracts/contracts/utils/Strings.sol";
// import {Strings} from "openzeppelin-contracts/contracts/utils/Strings.sol";

import {PermissionManager} from "../src/PermissionManager.sol";
import {PermissionCallPermission, UserOperation} from "../src/permissions/PermissionCallPermission.sol";

// w
contract Debug is Script, PermissionManager {

    struct SignatureWrapper {
        /// @dev The index of the owner that signed, see `MultiOwnable.ownerAtIndex`
        uint256 ownerIndex;
        /// @dev If `MultiOwnable.ownerAtIndex` is an Ethereum address, this should be `abi.encodePacked(r, s, v)`
        ///      If `MultiOwnable.ownerAtIndex` is a public key, this should be `abi.encode(WebAuthnAuth)`.
        bytes signatureData;
    }

    function run() public {
        vm.startBroadcast();

        // bytes memory sessionBytes = hex"0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000701bb57ef6c445513ba378b25a021234ad5053e4000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003a000000000000000000000000053946e4c9b6adedc9d0b1a9d413c0b05c97ab9b30000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000005e0bef4d0000000000000000000000000000000000000000000000000000000000014a34000000000000000000000000db9f9b82a37553e75808669c7910cdfc9026bea500000000000000000000000000000000000000000000000000000000000002800000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000001700000000000000000000000000000000000000000000000000000000000000012c6b4aad56eb6b3e2917f9466c71a3316277f8add168fdb4602bc8761bf07ced35203df9744b020c315603c7293b12a668adf98dd3b2fe9550a6d5a8ba6e02e7000000000000000000000000000000000000000000000000000000000000002549960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d9763050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000867b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a226a4f3676485a656b6c6251594b4d49733654627672674d2d5670597461386249506532627459676e533051222c226f726967696e223a22687474703a2f2f6c6f63616c686f73743a33303035222c2263726f73734f726967696e223a66616c73657d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040ab4ba307d567bcf7e656e6562e1500dbe5a727845c68c07f04ea425089f984625f4f2f4d9bcded517ece439d60be0e4d96b27813e3995bde7b888affbea0f91600000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000100";
        // (Permission memory session) = abi.decode(sessionBytes, (Permission));

        // bytes memory sessionAndSigData = hex"00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000480000000000000000000000000701bb57ef6c445513ba378b25a021234ad5053e4000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003a000000000000000000000000053946e4c9b6adedc9d0b1a9d413c0b05c97ab9b30000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000005e0bef4d0000000000000000000000000000000000000000000000000000000000014a34000000000000000000000000db9f9b82a37553e75808669c7910cdfc9026bea500000000000000000000000000000000000000000000000000000000000002800000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000170000000000000000000000000000000000000000000000000000000000000001b6db6ec1dcab0a73070e5be85f42a0a9a039daaff9cc928a99ed04ea86698bd213f5763e6c737f1d07920cd82e295d413d1e79360f187e273299af4e45b577d7000000000000000000000000000000000000000000000000000000000000002549960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d9763050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000867b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a226a4f3676485a656b6c6251594b4d49733654627672674d2d5670597461386249506532627459676e533051222c226f726967696e223a22687474703a2f2f6c6f63616c686f73743a33303035222c2263726f73734f726967696e223a66616c73657d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040ab4ba307d567bcf7e656e6562e1500dbe5a727845c68c07f04ea425089f984625f4f2f4d9bcded517ece439d60be0e4d96b27813e3995bde7b888affbea0f9160000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002e00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000260000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000170000000000000000000000000000000000000000000000000000000000000001cbac8472b9fc94981f03465bd34cfd8efbeb479b16550fd953a16b7a2a6fa28d0f1d8a24cc8cc549607020c3c05f57025103a747f1a7426fa2b9d56784e087fa000000000000000000000000000000000000000000000000000000000000002549960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d9763050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f37b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a226c537161456c6856714979377a335f69737071744d426e696a7047746439656b5a4f62553152596c595449222c226f726967696e223a22687474703a2f2f6c6f63616c686f73743a35313733222c2263726f73734f726967696e223a66616c73652c226f746865725f6b6579735f63616e5f62655f61646465645f68657265223a22646f206e6f7420636f6d7061726520636c69656e74446174614a534f4e20616761696e737420612074656d706c6174652e205365652068747470733a2f2f676f6f2e676c2f796162506578227d00000000000000000000000000";
        // (bytes memory session, bytes memory sig) = abi.decode(sessionAndSigData, (bytes, bytes));
        // bytes memory sessionBytes = abi.encodePacked(0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000701bb57ef6c445513ba378b25a021234ad5053e4000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003a000000000000000000000000053946e4c9b6adedc9d0b1a9d413c0b05c97ab9b30000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000005e0bef4d0000000000000000000000000000000000000000000000000000000000014a34000000000000000000000000db9f9b82a37553e75808669c7910cdfc9026bea500000000000000000000000000000000000000000000000000000000000002800000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000001700000000000000000000000000000000000000000000000000000000000000012c6b4aad56eb6b3e2917f9466c71a3316277f8add168fdb4602bc8761bf07ced35203df9744b020c315603c7293b12a668adf98dd3b2fe9550a6d5a8ba6e02e7000000000000000000000000000000000000000000000000000000000000002549960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d9763050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000867b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a226a4f3676485a656b6c6251594b4d49733654627672674d2d5670597461386249506532627459676e533051222c226f726967696e223a22687474703a2f2f6c6f63616c686f73743a33303035222c2263726f73734f726967696e223a66616c73657d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040ab4ba307d567bcf7e656e6562e1500dbe5a727845c68c07f04ea425089f984625f4f2f4d9bcded517ece439d60be0e4d96b27813e3995bde7b888affbea0f91600000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000100);
        bytes memory userOpSig = hex"0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000004a00000000000000000000000000000000000000000000000000000000000000740000000000000000000000000701bb57ef6c445513ba378b25a021234ad5053e4000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003a000000000000000000000000053946e4c9b6adedc9d0b1a9d413c0b05c97ab9b30000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000005e0bef4d0000000000000000000000000000000000000000000000000000000000014a34000000000000000000000000db9f9b82a37553e75808669c7910cdfc9026bea500000000000000000000000000000000000000000000000000000000000002800000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000001700000000000000000000000000000000000000000000000000000000000000012c6b4aad56eb6b3e2917f9466c71a3316277f8add168fdb4602bc8761bf07ced35203df9744b020c315603c7293b12a668adf98dd3b2fe9550a6d5a8ba6e02e7000000000000000000000000000000000000000000000000000000000000002549960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d9763050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000867b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a226a4f3676485a656b6c6251594b4d49733654627672674d2d5670597461386249506532627459676e533051222c226f726967696e223a22687474703a2f2f6c6f63616c686f73743a33303035222c2263726f73734f726967696e223a66616c73657d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040ab4ba307d567bcf7e656e6562e1500dbe5a727845c68c07f04ea425089f984625f4f2f4d9bcded517ece439d60be0e4d96b27813e3995bde7b888affbea0f9160000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002800000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000001700000000000000000000000000000000000000000000000000000000000000018f2143a5f15c9a10e6a55456d54bb6315084ff7ed54060d799e0ae1e411596356af706385775cf5def03e8f12fdb734be8a8d020b3e0930d83de63332385aa11000000000000000000000000000000000000000000000000000000000000002549960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d9763050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000867b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a22514f326f7775714f63537247344673485f5349466f3457587036686c662d594d7476314278545a4564646f222c226f726967696e223a22687474703a2f2f6c6f63616c686f73743a35313733222c2263726f73734f726967696e223a66616c73657d0000000000000000000000000000000000000000000000000000000000000000000000000000701bb57ef6c445513ba378b25a021234ad5053e400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000130f1000000000000000000000000000000000000000000000000000000000010c37200000000000000000000000000000000000000000000000000000000000a562c00000000000000000000000000000000000000000000000000000000001e883600000000000000000000000000000000000000000000000000000000001e848000000000000000000000000000000000000000000000000000000000000003600000000000000000000000000000000000000000000000000000000000000420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001a434fcd5be000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000416edd85fa37a3be56b9fe95b996359b539da1a30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a47bc361a300000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000044beebc5da000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000095f5d253b62543c6ef526309d497f619cef95ad430000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008a796dd47b539cf643122303bbc7503abe4c250d53734ed1cd439bdccaa3656d2055e5385e5389e865b15a9c41a5dddd8369aa81b46466c10196767d0f06b5051b000000000000000000000000000000000000000000000000000000000000000000000000000000000002800000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000170000000000000000000000000000000000000000000000000000000000000001949fc7c88032b9fcb5f6efc7a7b8c63668eae9871b765e23123bb473ff57aa831a7c0d9276168ebcc29f2875a0239cffdf2a9cd1c2007c5c77c071db9264df1d000000000000000000000000000000000000000000000000000000000000002549960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97630500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008a7b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a2273496a396e6164474850596759334b7156384f7a4a666c726275504b474f716d59576f4d57516869467773222c226f726967696e223a2268747470733a2f2f7369676e2e636f696e626173652e636f6d222c2263726f73734f726967696e223a66616c73657d00000000000000000000000000000000000000000000";
        SignatureWrapper memory sigWrapper = abi.decode(userOpSig, (SignatureWrapper));
        uint256 ownerIndex = sigWrapper.ownerIndex;

        // bytes memory authData = abi.encodePacked(b32);
        // bytes memory authData = abi.encodePacked(0x000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000004a00000000000000000000000000000000000000000000000000000000000000740000000000000000000000000701bb57ef6c445513ba378b25a021234ad5053e4000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003a000000000000000000000000053946e4c9b6adedc9d0b1a9d413c0b05c97ab9b30000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000005e0bef4d0000000000000000000000000000000000000000000000000000000000014a34000000000000000000000000db9f9b82a37553e75808669c7910cdfc9026bea500000000000000000000000000000000000000000000000000000000000002800000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000001700000000000000000000000000000000000000000000000000000000000000012c6b4aad56eb6b3e2917f9466c71a3316277f8add168fdb4602bc8761bf07ced35203df9744b020c315603c7293b12a668adf98dd3b2fe9550a6d5a8ba6e02e7000000000000000000000000000000000000000000000000000000000000002549960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d9763050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000867b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a226a4f3676485a656b6c6251594b4d49733654627672674d2d5670597461386249506532627459676e533051222c226f726967696e223a22687474703a2f2f6c6f63616c686f73743a33303035222c2263726f73734f726967696e223a66616c73657d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040ab4ba307d567bcf7e656e6562e1500dbe5a727845c68c07f04ea425089f984625f4f2f4d9bcded517ece439d60be0e4d96b27813e3995bde7b888affbea0f9160000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002800000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000017000000000000000000000000000000000000000000000000000000000000000116dfa4b725aa83af08e59c968c750679084e5ebc254d925c71dd6d9c25a200cf7b7c34db058d1d59e1720c5ded86e81fe09fea775e45c43adcacffdae117b2dc000000000000000000000000000000000000000000000000000000000000002549960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d9763050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000867b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a224637685f6e52714b4d31754a597a4173444a3471364c31784932753570524a3357574e5438576b49454a59222c226f726967696e223a22687474703a2f2f6c6f63616c686f73743a35313733222c2263726f73734f726967696e223a66616c73657d0000000000000000000000000000000000000000000000000000000000000000000000000000701bb57ef6c445513ba378b25a021234ad5053e400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000130f1000000000000000000000000000000000000000000000000000000000010c37200000000000000000000000000000000000000000000000000000000000b8c3100000000000000000000000000000000000000000000000000000000001e882e00000000000000000000000000000000000000000000000000000000001e848000000000000000000000000000000000000000000000000000000000000003600000000000000000000000000000000000000000000000000000000000000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001a434fcd5be000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000416edd85fa37a3be56b9fe95b996359b539da1a30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a47bc361a300000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000044beebc5da00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002800000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000170000000000000000000000000000000000000000000000000000000000000001949fc7c88032b9fcb5f6efc7a7b8c63668eae9871b765e23123bb473ff57aa831a7c0d9276168ebcc29f2875a0239cffdf2a9cd1c2007c5c77c071db9264df1d000000000000000000000000000000000000000000000000000000000000002549960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97630500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008a7b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a2273496a396e6164474850596759334b7156384f7a4a666c726275504b474f716d59576f4d57516869467773222c226f726967696e223a2268747470733a2f2f7369676e2e636f696e626173652e636f6d222c2263726f73734f726967696e223a66616c73657d00000000000000000000000000000000000000000000);
        bytes memory authData = hex"000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000004a00000000000000000000000000000000000000000000000000000000000000740000000000000000000000000701bb57ef6c445513ba378b25a021234ad5053e4000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003a000000000000000000000000053946e4c9b6adedc9d0b1a9d413c0b05c97ab9b30000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000005e0bef4d0000000000000000000000000000000000000000000000000000000000014a34000000000000000000000000db9f9b82a37553e75808669c7910cdfc9026bea500000000000000000000000000000000000000000000000000000000000002800000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000001700000000000000000000000000000000000000000000000000000000000000012c6b4aad56eb6b3e2917f9466c71a3316277f8add168fdb4602bc8761bf07ced35203df9744b020c315603c7293b12a668adf98dd3b2fe9550a6d5a8ba6e02e7000000000000000000000000000000000000000000000000000000000000002549960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d9763050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000867b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a226a4f3676485a656b6c6251594b4d49733654627672674d2d5670597461386249506532627459676e533051222c226f726967696e223a22687474703a2f2f6c6f63616c686f73743a33303035222c2263726f73734f726967696e223a66616c73657d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040ab4ba307d567bcf7e656e6562e1500dbe5a727845c68c07f04ea425089f984625f4f2f4d9bcded517ece439d60be0e4d96b27813e3995bde7b888affbea0f9160000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002800000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000017000000000000000000000000000000000000000000000000000000000000000116dfa4b725aa83af08e59c968c750679084e5ebc254d925c71dd6d9c25a200cf7b7c34db058d1d59e1720c5ded86e81fe09fea775e45c43adcacffdae117b2dc000000000000000000000000000000000000000000000000000000000000002549960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d9763050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000867b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a224637685f6e52714b4d31754a597a4173444a3471364c31784932753570524a3357574e5438576b49454a59222c226f726967696e223a22687474703a2f2f6c6f63616c686f73743a35313733222c2263726f73734f726967696e223a66616c73657d0000000000000000000000000000000000000000000000000000000000000000000000000000701bb57ef6c445513ba378b25a021234ad5053e400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000130f1000000000000000000000000000000000000000000000000000000000010c37200000000000000000000000000000000000000000000000000000000000b8c3100000000000000000000000000000000000000000000000000000000001e882e00000000000000000000000000000000000000000000000000000000001e848000000000000000000000000000000000000000000000000000000000000003600000000000000000000000000000000000000000000000000000000000000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001a434fcd5be000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000416edd85fa37a3be56b9fe95b996359b539da1a30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a47bc361a300000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000044beebc5da00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002800000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000170000000000000000000000000000000000000000000000000000000000000001949fc7c88032b9fcb5f6efc7a7b8c63668eae9871b765e23123bb473ff57aa831a7c0d9276168ebcc29f2875a0239cffdf2a9cd1c2007c5c77c071db9264df1d000000000000000000000000000000000000000000000000000000000000002549960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97630500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008a7b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a2273496a396e6164474850596759334b7156384f7a4a666c726275504b474f716d59576f4d57516869467773222c226f726967696e223a2268747470733a2f2f7369676e2e636f696e626173652e636f6d222c2263726f73734f726967696e223a66616c73657d00000000000000000000000000000000000000000000";
        (Permission memory session, bytes memory signature, UserOperation memory userOp) = abi.decode(authData, (Permission, bytes, UserOperation));
        bytes memory requestData = abi.encode(userOp);
        bytes memory newAuthData = abi.encode(session, signature, requestData);
        // console2.logBytes(newAuthData);

        SignatureWrapper memory newSigWrapper = SignatureWrapper(3, newAuthData);
        bytes memory newSignature = abi.encode(newSigWrapper);
        console2.logBytes(newSignature);

        // console2.logAddress(session.verifyingContract);

        vm.stopBroadcast();
    }

    function logAddress(string memory name, address addr) internal pure {
        console2.logString(string.concat(name, ": ", Strings.toHexString(addr)));
    }
}
